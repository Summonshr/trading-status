<!DOCTYPE HTML>
<html>
	<head>
		<title>Smark Karobaar trading chart</title>
		<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="IE=Edge">
		<script type="text/javascript" src="charting_library/charting_library.min.js"></script>
		<script type="text/javascript" src="datafeeds/udf/dist/polyfills.js"></script>
		<script type="text/javascript" src="datafeeds/udf/dist/bundle.js"></script>
	</head>

	<body style="margin:0px;">
		<div id="app">
			<div id="tv_chart_container"></div>
		</div>
	</body>
	<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
	<script defer>
		const { createApp } = Vue
		createApp({
			methods: {
				getParameterByName(name) {
					name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
					var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
						results = regex.exec(location.search);
					return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
				},
			},
			mounted() {
				new TradingView.widget(this.meta);
			},
			data() {
				return {
					meta: {
						fullscreen: true,
						symbol: 'NEPSE',
						interval: 'D',
						container_id: "tv_chart_container",
						// datafeed: new Datafeeds.UDFCompatibleDatafeed("http://0.0.0.0:3000"),
						datafeed: new Datafeeds.UDFCompatibleDatafeed("https://smartkarobaar.com/admin/public/api/trading"),
						library_path: "charting_library/",
						locale: this.getParameterByName('lang') || "en",
						disabled_features: ["use_localstorage_for_settings"],
						enabled_features: ["study_templates"],
						charts_storage_url: 'http://saveload.tradingview.com',
						charts_storage_api_version: "1.1",
						client_id: 'tradingview.com',
						user_id: 'public_user_id',
						theme: this.getParameterByName('theme'),
					}
				}
			}
		}).mount('#app')
	</script>
</html>
